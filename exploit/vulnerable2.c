#include <stdio.h>
#include <unistd.h>
#include <string.h>
#include <stdbool.h>

#define USER "ARTHURCHAN"
#define PASS "123456789"

int main(int argc, char **argv) {
        char user[21];
        char pass[21];
        char mess[20];

        if (argc != 4) {
                fprintf(stderr, "bad arguments\n");
                return -1;
        }

        strncpy(user, argv[1], sizeof(user) - 1);
        strncpy(pass, argv[2], sizeof(pass) - 1);
        strncpy(mess, argv[3], sizeof(mess));

        while (true) {
                if (!strcmp(user,USER) && !strcmp(pass,PASS)) {
                        printf("Correct Password!!");

                        FILE *file = fopen("messageboard.txt", "a");
                        fprintf(file, "%s", mess);
                        fclose(file);

                        break;
                } else {
                        printf("Wrong Credential!! Enter username again:");
                        if (!fgets(user, sizeof(user), stdin)) {
                                return -1;
                        }
                        printf("Enter password again:");
                        if (!fgets(pass, sizeof(pass), stdin)) {
                                return -1;
                        }

                        user[strcspn(user, "\n")] = '\0';
                        pass[strcspn(pass, "\n")] = '\0';
                }
        }

	return 0;
}
